<html>
  <title>Bespoken NLP Benchmark - Success By Platform</title>
  <head>
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Khand' rel='stylesheet' type='text/css'>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
  </head>
  <body>
    <canvas id="canvas" height="400" width="600"></canvas>
    <script>

		window.onload = async function() {
      var ctx = document.getElementById('canvas').getContext('2d');
      const response = await axios.get('/successByPlatform')
      console.log('DATA: ' + JSON.stringify(response.data))
      
      const rawData = response.data
      const chartData = {
        labels: ['Amazon Alexa', 'Google Assistant'],
        datasets: [{
          backgroundColor: [
            'rgba(93, 188, 210, 1.0)',
            'rgba(250, 189, 3, 1.0)'
          ],
          borderWidth: 0,
          data: [rawData.alexa.successPercentage, rawData.google.successPercentage],
          label: "Success By Platform"
        }]
      }

      const options = {
        type: 'bar',
        data: chartData,
        options: {
          legend: {
            display: false,
            position: 'end'
          },
          plugins: {
            // Change options for ALL labels of THIS CHART
            datalabels: {
                align: 'top',
                anchor: 'end',
                font: {
                  family: 'Roboto Condensed',
                  size: 14,
                  weight: 'bold'
                },
                formatter: (s) => {
                  return s + '%'
                },
                textAlign: 'top'
            }
          }, 
          responsive: false,
          scales: {
            yAxes: [{
              display: true,
              gridLines: {
                color: 'rgb(0,0,0)',
                display: true,
                drawOnChartArea: false,
                drawTicks: false
              },
              ticks: {
                  beginAtZero: true,
                  padding: 10,
                  max: 100,
                  stepSize: 50
              }
            }],
            xAxes: [{
              gridLines: {
                color: 'rgb(0,0,0)',
                display: true,
                drawOnChartArea: false,
                drawTicks: false
              },
              ticks: {
                  padding: 10
              }
            }]
          },
          title: {
            display: true,
            fontFamily: 'Khand',
            fontSize: 20,
            text: 'Success By Platform'
          }
        }
      }

      Chart.defaults.global.defaultFontFamily = 'Roboto Condensed';
      Chart.defaults.global.defaultFontSize = 16;
      Chart.defaults.global.defaultFontColor = 'rgb(0,0,0)';
      window.myBar = new Chart(ctx, options)
		};
    </script>
  </body>
</html>